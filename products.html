


<html>

    <head>
    
    
        <title>Products | Comfy JavaScript</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="index.css"> 
       <!--  <script src="reviews.js"></script>  --> 
       <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap" rel="stylesheet">
       <link href="https://fonts.googleapis.com/css2?family=Kaushan+Script&display=swap" rel="stylesheet">
        <script src="https://use.fontawesome.com/031e3862f6.js"></script>

        <style>
       /*     body{
                background-color: #FFFFFF;
                padding: 0;
                margin: 0;
            }
            #main_container{
              position: relative;
          }
          .main_container::after{
                content: "";
                position: absolute;
                z-index: 1;
                background:rgba(0,0,0,0.5);
               
               top:0;
               bottom: 0;
               right: 0;
               left: 0;

            }
            #header_container{
              width:80vw;
              margin: auto;
          }
          #header{
              
             
              text-align: center;
             display: flex;
             justify-content: center;
             padding: 10px 0px;
          
             
          }

          #navbar{
            align-self: center;
             flex:33%;
             text-align: left;
           
          }


          .links{
            
              text-decoration: none;
              cursor: pointer;
              color:#102A42;
              font-size: 22px;
              padding: 10px;
              font-family: 'Roboto', sans-serif;
              letter-spacing: 2px;
              transition: color 1s;
          }

          .links:hover{
              color:#BA5D2C;
          }
          #logo{
              padding: 0;
              margin: 0;
              flex:33%;
              
              display: inline-block;
             
              
          }
          #cart_container{
              align-self: center;
              flex:33%;
              float: right;
              display: inline;
            
             position: relative;
             cursor: pointer;

          }
          #cart{
              position: absolute;
              top:-10;
              right:-10;
              color:#102A42;
              font-size: 2rem;
          }
          #items_in_cart_div{
              background-color: #BA5D2C;
              color:white;
              border-radius: 50%;
              padding: 5px 8px;
              position: absolute;
              top:-27;
              right:-20;
              cursor: pointer;
          }
          #items_in_cart{
              font-family: 'Roboto', sans-serif;

          }
          .page_title{
              background-color: #F1F5F8;
              width:100vw;
              color:#617D98;
              padding: 50px 0px;
             
          }
          .page_title h1{
              width:80vw;
              margin: auto;
              font-family: 'Roboto', sans-serif;
                letter-spacing: 2px;
                text-align: left;
              } */

              /* Start Product Flex Container Styling*/
          /*  #products_flex_container{
                width: 80vw;
                margin: auto;
                display: flex;
                padding: 50px 0px;
            }
            #filter{
                flex:20%;
              
            }

            #all_products_flex{
                flex:80%;

            }
        
            #all_products_grid{
                
                display: grid;
                grid-template-columns: 33% 33% 33%;
                grid-column-gap: 20px;
                grid-row-gap: 20px;
               
            }
            .product{
                text-align: center;
            }
            .product_img_container{
                position: relative;
                cursor: pointer;

            }
            .icon{
                position: absolute;
                border-radius: 50%;
                padding: 10px;
                background-color: #BA5D2C;
                top:40%;
                left:30%;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;

                }
                .quick_look{
                 left:30%;
                    }
                    .buy_now{
                        left:50%;
                    }
                 .icon:hover{
                background-color: lightsalmon;

                 }
                 .hideIcon{
             visibility: hidden;
                }
            .showIcon{
             visibility: visible;
                 }

             .image{
                border-radius: 10px;
                object-fit:cover;
                width: 95%;
                height: 10vw;
                
             

            }
            .product_name{
                color:#617D98;
                font-family: 'Roboto', sans-serif;
                margin: 0;
                padding: 8px;

            }
            .product_price{
                color:#324D67;
                font-family: 'Roboto', sans-serif;
                margin: 0;
                padding: 0;
                font-weight: 900;
            }
            #search{
                background-color: #F1F5F8;
                padding: 10px;
                border-radius: 5px;
                border:none;
                font-family: 'Roboto', sans-serif;
                letter-spacing: 2px;
                margin-bottom: 20px;

            }
            #filter h4{
                color:#102A42;
                font-family: 'Roboto', sans-serif;
                letter-spacing: 2px;
                padding:  0px;
                margin:0px;


            }
            #filter p{
                color:#617D98;
                font-family: 'Roboto', sans-serif;
                letter-spacing: 2px;
               
                letter-spacing: 0;
                padding: 5px;
                margin: 0;


            }
            .filter_option{
                display: block;
                border:none;
                cursor: pointer;
                padding-left: 10px;
                color:#617D98;
                margin:10px;
                font-size: 15px;
                background-color:  #FFFFFF;;
                font-family: 'Roboto', sans-serif;
                letter-spacing: 2px;
            }
            .filter_option:hover{
                color:#324D67;
            }
            #slider{
               
                margin: 8px 0px;
                cursor: pointer;
            } */
             /* Side Menu Styling */
          /*   #side_menu{
             position: fixed;
            background-color: #F1F5F8;
            width:350px;
            z-index: 2;
            top:0;
            right:0;
           
            height: 100vh;
            overflow: hidden;
           text-align: center;
           overflow: hidden;
            transition: transform 1s;

         }
         .hide_sidemenu{
            transform: translateX(100%);
         }
         .show_sidemenu{
             transform: translateX(0);
         }
         #close{
             padding: 15px;
             color:#617D98;
             font-size: 2rem;
             cursor: pointer;
             display: inline;
             float: left;

         }
         #side_menu h2{
             clear: both;
            text-align: center;
            font-family: 'Kaushan Script', cursive;
            font-size: 25px;
            color:#102A42;
            letter-spacing: 1px;
         }
         #sidemenu_bottom{
            position: fixed; 
             top:80vh;
             width:70%;
             left:15%; 
             
             font-family: 'Kaushan Script', cursive;
             font-size: 30px;
            letter-spacing: 2px;
         }

         #checkout{
             background-color: #BA5D2C;
             border-radius: 10px;
             padding: 10px;
             color:white;
            margin: 10px;
             border:none;
            width: 100%;
             letter-spacing: 2px;
             cursor: pointer;
             display: block;
             transition: color 1s,background-color 1s;

         }
         #total{
            font-family: 'Kaushan Script', cursive;
             font-size: 30px;

         }

         #checkout:hover{
             color:#324D67;
             background-color: lightsalmon;
           

         } */
         /* Your Shopping Bag Styling */
        /*
         #your_bag{
        padding: 5px;
        display: flex;
        flex-direction: column;
        row-gap: 20px;

        }
        .your_bag_container{
        display: grid;
        grid-template-columns: 30% 55% 10%;
        text-align: left;
        grid-column-gap: 5px;
        grid-row-gap: 20px;

        }
        .cart_details{
        padding-left: 10px;
        }
        .cart_image{
        border-radius: 5px;
        width: 100%;
        object-fit: cover;
        height:10vh
        }
        .cart_product_name{
        color:#324D67;
        letter-spacing: 1px;
        padding: 0;
        margin: 0;
        }
        .cart_product_price{
        color:#617D98;
        padding: 0;
        margin: 0;
        margin-bottom: 10px;
        margin-top: 3px;
        }
        .remove{
        color:#617D98;
        border:none;
        background-color: #F1F5F8;
        padding: 0;
        margin: 0;
        cursor: pointer;
        outline: none;
        }
        .quantity_container{
        display: flex;
        flex-direction: column;
        align-content: center;
        }
        .up_arrow,.down_arrow{
        color:#BA5D2C;
        font-weight: 300;
        cursor: pointer;
        font-size: 1.5rem;
        border:none;
        background-color: #F1F5F8;
        align-self: center;

        }
        .quantity{
        align-self: center; 
        } */


        </style>
        
    
        
    </head>


    <body>
        <div id="main_container">
        <div id="header_container">
            <div id="header">

                <div id="navbar"> 
                    <a href="./index.html" class="links">Home</a>

                    <a href="./products.html" class="links">Products</a>

                    <a href="./about.html" class="links">About</a>


                </div>

                 <div id="logo"> <img  src="https://vanilla-js-store.netlify.app/images/logo-black.svg"></div>

                <div id="cart_container">
                    <span id="cart"><i class="fa fa-shopping-cart"></i></span>
                    <div id="items_in_cart_div" ><span id="items_in_cart">1</span></div>
                </div>

            </div> 
            
        </div>
        <div class="page_title">

            <h1>Home/ <span id="breadcrumb">High-Back Bench</span></h1>


        </div>

        <div id="products_flex_container">

            <div id="filter">
                <div> <input type="text" id="search" placeholder="Search...">  </div>
                <div id="company"> 
                    <h4>Company</h4>
                    <button class="filter_option">All</button>
                    <button class="filter_option">Ikea</button>
                    <button class="filter_option">Marcos</button>
                    <button class="filter_option">Caressa</button>
                    <button class="filter_option">Liddy</button>
                </div>
               
                <h4>Price</h4>
                <input type="range" min="0" max="80" value="80" id="slider">
                <p>Value: $ <span id="slider_value">80</span></p>


               

            </div>

            <div id="all_products_flex">
                
            <div id="all_products_grid">
               
               

             <!--     <div class="product">
                <div class="product_img_container">  
                    <img class="image" src="https://dl.airtable.com/.attachmentThumbnails/d86e13eec1b200e2b21282b99a9382be/6d92321b">
                    <div class="quick_look icon hideIcon"><i class="fa fa-search"></i></div>
                    <div class="buy_now icon hideIcon"><i class="fa fa-shopping-cart"></i></div>
                
                </div>
                    <p class="product_name">High-Back Bench</p>

                    <p class="product_price">$9.99</p>

                </div>

             -->

            </div>

            </div>


        </div>

        <div id="side_menu" class="hide_sidemenu">
            <div id="close"><i class="fa fa-times"></i></div>
            <h2>Your Bag</h2>
            
            <div id="your_bag">

            </div>
            <div id="sidemenu_bottom">Total:$ <span id="total"> 0.00</span>
            <button id="checkout">CHECKOUT</button> </div>

        </div>
        
       
        </div>
        <script>

            window.onload = function(){
                let product_section; let formatted_price; let product_img_container; let icons; let   buy_now;

                let remove_elm; let increase_quantity_elm; let  decrease_quantity_elm;

                 // Get Cart Information from Local Storage
                let items_in_cart = localStorage.getItem("your_bag_elm"); 
 

                let product_clicked; let company_filter ="All";  let user_search ="" ; let user_search_length; let slider_value;

                const all_products_grid = document.getElementById("all_products_grid");

                const filter_option = document.querySelectorAll(".filter_option");

                const search_elm = document.getElementById("search");

                search_elm.addEventListener("input",onUserSearch);

                //Filter out based on company, fetch them from API and then populate DOM
                function fetchProducts(){
                    console.log("fetch")
                    console.log(user_search)
                fetch("https://course-api.netlify.app/api/javascript-store-products")
                .then(response => response.json())
                .then(data => {




                        product_section  =  data.filter(function(elm,index){

                                    const {company,name} = elm.fields;

                                    if(user_search != "" ){
                                    console.log("user_search filter")
                                    user_search_length = user_search.length;

                                    return name.slice(0,user_search_length) == user_search
                                                
                                    }
                                        

                                   if(company_filter == "All"){

                                        return company == "ikea" || company == "marcos" || company == "caressa" || company == "liddy";
                                    } else {  return company == company_filter.toLowerCase() }
                                    
                                   

                                    }).map(function(elm,index){

                            const{url} = elm.fields.image[0];

                            const {price,name} = elm.fields;

                            formatted_price = String(price).split("");

                            formatted_price.splice(formatted_price.length-2,0,".");

                            return `  <div class="product">
                                <div class="product_img_container">  
                                    <img class="image" src=${url}>
                                    <div class="quick_look icon hideIcon"><i class="fa fa-search"></i></div>
                                    <div class="buy_now icon hideIcon"><i class="fa fa-shopping-cart"></i></div>
                                
                                </div>
                                    <p class="product_name">${name.toUpperCase()}</p>

                                    <p class="product_price">$ ${formatted_price.join("")}</p>

                                </div>`

                        }).join("");

                       

                        all_products_grid.innerHTML = product_section;

                        search_elm.value="";
                        

                        product_img_container = document.querySelectorAll(".product_img_container");

                        product_img_container.forEach(elm=>elm.addEventListener("mouseover",showIcon))

                        product_img_container.forEach(elm=>elm.addEventListener("mouseout",hideIcon))

                        quick_look = document.querySelectorAll(".quick_look");

                   quick_look.forEach(elm => elm.addEventListener("click",goToProductPage))

                   buy_now = document.querySelectorAll(".buy_now");

                    buy_now.forEach(elm=> elm.addEventListener("click",add_to_cart));




                })

            }
            
                 fetchProducts();


                 // User Chooses a Company Filter
                filter_option.forEach(elm => elm.addEventListener("click",fetchFilteredProducts))

                function fetchFilteredProducts(){

                    company_filter = this.textContent;
                     fetchProducts();

                }

                // When a product is clicked On , go to product detail page
                function goToProductPage(){


                    product_clicked = this.parentElement.nextElementSibling.textContent;
                    console.log(product_clicked)

                    localStorage.setItem("product_clicked",product_clicked.toLowerCase());

                    location.assign("./product.html")
                    
                }

                // On hover show Quick Look and Add to cart
                function showIcon(){

                    icons = this.children;

                    [...icons].forEach(function(elm,index){

                        if(index == 1 || index ==2){

                            elm.classList.remove("hideIcon")
                            elm.classList.add("showIcon")


                        }


                    })


                }

                 // On mouse out hide Quick Look and Add to cart
                function hideIcon(){
                        icons = this.children;

                        [...icons].forEach(function(elm,index){

                            if(index == 1 || index ==2){

                                elm.classList.remove("showIcon")
                                elm.classList.add("hideIcon")


                            }


                        })


                        }

                //When user searches for a product

                function onUserSearch(){

                    user_search = this.value;
                    console.log(user_search)
                    fetchProducts();
                   


                }

                //When price changes on slider

                const slider = document.getElementById("slider")

                slider.addEventListener("input",sliderChange);

                let slider_value_elm = document.getElementById("slider_value");



                function sliderChange(){


                    slider_value_elm.innerHTML = this.value;
                    slider_value = this.value;



                }

                
                
              


                // Show and Hide Side Menu

             //Show Side Menu on click of Cart 
             const homepage = document.getElementById("main_container")

             const sideMenu = document.getElementById("side_menu")

            const cart_button = document.getElementById("cart_container");

            cart_button.onclick = function(){

        

            sideMenu.classList.remove("hide_sidemenu")

            sideMenu.classList.add("show_sidemenu");

            homepage.classList.add("main_container")


            

        }
            // Hide Side Menu on close

            const close_sidemenu =document.getElementById("close")

            close_sidemenu.onclick = function(){

            sideMenu.classList.remove("show_sidemenu")

            sideMenu.classList.add("hide_sidemenu")

            homepage.classList.remove("main_container")


        }

         // Populate Shopping cart with string from previous page
            
            
         const your_bag_elm = document.getElementById("your_bag");

        const total_elm = document.getElementById("total");

        const update_cart_elm = document.getElementById("items_in_cart")

        if(items_in_cart){

            console.log("items in cart")
            your_bag_elm.innerHTML =items_in_cart;

           //Update Cart Quantity in the cart icon
           update_cart_elm.textContent = totalItemsInCart();

            total_elm.textContent = calculateTotal() ;

        }
          //Calculat the total Number of items or Quantity in your shopping Cart
          function totalItemsInCart(){
                let quantity_total=0;
                
                items_in_cart = document.querySelectorAll(".your_bag_container");

                items_in_cart.forEach(function(eachItem,index){

                    quantity_total += parseInt(eachItem.children[2].children[1].textContent)

                })

                return quantity_total;

             
                }

           function add_to_cart(){



               your_bag_elm.innerHTML += `   <div class="your_bag_container">
                                   <img class="cart_image" src=${this.parentElement.children[0].src}>
                           
                                   <div class="cart_details">
                                       <h4 class="cart_product_name">${this.parentElement.nextElementSibling.textContent}</h4>
                                       <h4 class="cart_product_price">${this.parentElement.parentElement.lastElementChild.textContent}</h4>
                                       <button class="remove">remove</button>
                                   </div>
                                   <div class="quantity_container">
                                       <button class="up_arrow"><i class="fa fa-angle-up"></i></button>
                                       <span class="quantity">1</span>
                                       <button class="down_arrow"><i class="fa fa-angle-down"></i></button>
                                   </div>
                                   </div>`


               cart_button.click();


           
               //Update Cart Quantity in the cart icon
            update_cart_elm.textContent = totalItemsInCart();
              
               // quantity = document.querySelectorAll(".quantity")  
               
               //console.log(items_in_cart)
               total_elm.textContent = calculateTotal() ;
              
               remove_elm = document.querySelectorAll(".remove");
               remove_elm.forEach( elm=> elm.addEventListener("click",remove_item_from_cart))
               increase_quantity_elm =  document.querySelectorAll(".up_arrow");

            decrease_quantity_elm =  document.querySelectorAll(".down_arrow");

            increase_quantity_elm.forEach(elm => elm.addEventListener("click",increaseQuantity));

            decrease_quantity_elm.forEach(elm => elm.addEventListener("click",decreaseQuantity));




           }
             remove_elm = document.querySelectorAll(".remove");


           remove_elm.forEach( elm=> elm.addEventListener("click",remove_item_from_cart))

           increase_quantity_elm =  document.querySelectorAll(".up_arrow");

            decrease_quantity_elm =  document.querySelectorAll(".down_arrow");

           increase_quantity_elm.forEach(elm => elm.addEventListener("click",increaseQuantity));

           decrease_quantity_elm.forEach(elm => elm.addEventListener("click",decreaseQuantity));



           function calculateTotal(){
               let total=0;
           
               items_in_cart = document.querySelectorAll(".your_bag_container");

                   items_in_cart.forEach(function(elm,index){

                       total += parseFloat((elm.querySelector(".cart_product_price").textContent).slice(1)).toFixed(2) * parseInt(elm.querySelector(".quantity").textContent)
                       

                   })
                   console.log(total)

                   return total.toFixed(2);

           }

           // To remove item is yoru shopping bag

           function remove_item_from_cart(){
           // console.log("remove")

               this.parentElement.parentElement.remove();

               console.log(  items_in_cart)

               total_elm.textContent = calculateTotal() ;
               
                //Update Cart Quantity in the cart icon
            update_cart_elm.textContent = totalItemsInCart();
               
           }

           //Increase quantity in shopping cart 
           function increaseQuantity(){
           
           this.nextElementSibling.textContent = parseInt( this.nextElementSibling.textContent) + 1;

           total_elm.textContent = calculateTotal() ;

            //Update Cart Quantity in the cart icon
            update_cart_elm.textContent = totalItemsInCart();
               

           }

           //Decrease quantity in shopping cart 
           function decreaseQuantity(){

               this.previousElementSibling.textContent = parseInt( this.previousElementSibling.textContent) - 1;

               if( parseInt(this.previousElementSibling.textContent) < 1){

                   this.previousElementSibling.textContent = 1;
               }

               total_elm.textContent = calculateTotal() ;

                //Update Cart Quantity in the cart icon
            update_cart_elm.textContent = totalItemsInCart();
               
           }

             // Set Cart Information to local Storage when user moves to another page
             window.addEventListener('beforeunload', function(event) {
                    
                    localStorage.setItem("your_bag_elm", your_bag_elm.innerHTML)
                
                });



                




            }
           
           
        </script>
        
   
    </body>


</html>